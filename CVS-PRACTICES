GASNet CVS Usage Practices
--------------------------
Development practices that GASNet developers are expected to follow:

* All developers doing commits must be on the upc-devel@lbl.gov email list,
  which receives gasnet checkin messages.

* You must include an explanatory log message for any change. It should describe
  the high-level of what you did, and why you did it (e.g. to solve a particular
  bug, etc). Generally larger changes deserve more detailed log messages -
  remember the idea is to keep other developers apprised of changes you've made
  that could affect their work somehow. Checkin messages should reference any 
  particular bug ID's that they address.

* You should only commit working code - do NOT check in untested or flagrantly
  broken code that could affect system stability. The idea is to ensure the main
  trunk of the repository is mostly-working at all times, so try to make sure
  your commits leave the repository in at least as working a state as you found
  it. I understand that it may not be practical to test a given change on all
  platforms, but you should at least test it throughly on your development
  platform, and any other platforms that you have reason to believe may be
  affected (this is especially true for configure scripts and Makefiles). If you
  wish to checkin intermediate or untested versions of your code, please do so
  on a private branch (see http://www.cvshome.org/docs/manual/cvs_5.html#SEC56).

* Whenever you add _any_ files to the CVS repository, make sure they also
  get added to the Makefile.am file for the enclosing directory (if there is one)
  otherwise your added file won't be included in the public release.

* When in doubt, use a CVS tag. CVS's built-in facilities for retrieving an old,
  consistent snapshot of the entire system are rather poor, and work most smoothly
  when there is a system-wide CVS tag at the point of interest. Developers
  should create a CVS tag with an explanatory name before any major change that
  is likely to affect system stability (eg merging a large development branch),
  before rolling back any non-trivial change, and whenever distributing a
  snapshot of the archive to any user or external party.

* Follow good CVS branch merging practice: when merging from the CVS head to a branch, 
  you should first tag the head, then merge to that tag. Subsequent merges will also
  require the tag from your last merge to the branch.

* When merging from the CVS head to a branch, perform a separate branch commit
  that contains nothing but the merge (and note that in the commit log). Do not 
  lump in your own branch changes along with a merge from the head, because that
  makes it harder to see what has actually changed in your commit, and muddies the
  branch history. If your working copy already has both the merged head updates 
  and your manual changes, you should checkout a separate copy of your branch, 
  merge the head to it and commit that to the branch, then cvs up your working
  copy before doing the commit of your real changes.

* GASNet supports both a regular and tools-only (conduit-free) distribution.
  The Bootstrap -o option activates tools-only mode for a given source tree
  by MODIFYING several source files, but the CVS repo is always kept in regular
  distribution mode. This means if you use tools-only mode, you MUST Bootstrap
  back to regular mode (without -o) before committing any changes to the repo.

* All GASNet developers are required to follow the GASNet coding standards outlined 
  in the top-level README.

GASNet Release Procedure
------------------------

* Start from a clean checkout of the CVS tree.
  Do *NOT* use an existing source tree - otherwise it's very easy for stray files,
  bad keywords, etc to end up in the release.
  Use the "-P" option to prune empty dirs (eg "cvs -f co -P ...")
  The "-f" ensures we don't pickup any undesired options from ~/.cvsrc

* Increment the version number for each item or software module that has changed
  since the last public release:
  Overall public release version number, in configure.in:
    GASNET_RELEASE_VERSION_MAJOR
    GASNET_RELEASE_VERSION_MINOR
    GASNET_RELEASE_VERSION_PATCH
  - this should be 1.3.x for development, then 1.4.0 for release based on
    1.3.x code (i.e. use odd minor version number for development).
  - For bug-fix release patches, update the patch number for each (ex: 1.4.1).
  - For development, update the patch number whenever it's useful (new feature, big
    bugfix), and/or whenever we put out a new 'stable' release (or hand
    out a snapshot to a user). The patch-level should be even for beta versions
    marked as "stable" for users, or odd for general development.
  GASNet spec version numbers, in configure.in:
    GASNET_SPEC_VERSION_MAJOR - increment on back-compat break
    GASNET_SPEC_VERSION_MINOR - increment for new features that don't break back-compat
  GASNet tools spec version numbers, in configure.in:
    GASNETT_SPEC_VERSION_MAJOR - increment on back-compat break
    GASNETT_SPEC_VERSION_MINOR - increment for new features that don't break back-compat
  Conduits: */gasnet_core_fwd.h, */gasnet_extended_fwd.h
  GASNet document spec version: docs/gasnet.texi
  GASNet tools document spec version: README-tools

* Review checkin messages and write a summary of user-visible changes and 
  bug fixes since last public release - add to ChangeLog

* Update license.txt with any new authorship credits

* ./Bootstrap the srcdir

* From a separate builddir, do a configure, then
     gmake all distcheck [GASNET_DOCS=PATH_TO_GASNET_DOCUMENTATION]
  the release candidate archive.  See below for info on the optional
  GASNET_DOCS setting.

* Unpack the archive and diff against the source tree to find missing files,
  especially documentation and auxiliary files.  Check that other/contrib
  contains any cross-configure scripts that are intended for distribution.

* Verify that ./unBootstrap removes all generated files:
  In the srcdir:
    ./unBootstrap
    cvs up -P | grep ^?
  If there is any output then you'll need to update unBootstrap.

* Check the spec documents were generated correctly & clean up if necessary 
  (regenerate the .ps on Linux)
  If the spec has not changed since the previous release, consider reusing
  the generated files.  That can be automated by adding
     GASNET_DOCS=PATH_TO_GASNET_DOCUMENTATION
  to the distcheck step.

* Test the release candidate on all directly supported systems and conduits,
  with both debug-stats-trace and ndebug configs, and all supported backend
  C compilers:
   IBM BG/P: dcmf (and mpi if time/allocation allows)
   IBM BG/Q: pami (and mpi if time/allocation allows)
   Cray XE: gemini (and mpi if time/allocation allows)
   Cray XC: aries (and mpi if time/allocation allows)
   Linux-Ethernet: mpi, udp
   Linux-InfiniBand: mpi, ibv (and portals4 & mxm, if possible)
   Linux-Altix: smp, shmem
   Windows/Cygwin: smp+pthreads
   Mac OS X: smp+pthreads
  In most cases these test will be conducted as part of Berkeley UPC's
  release testing (the "gasnet-tests" suite of the BUPC test harness).

* Install the release candidate and ensure that share/docs/gasnet contains
  all the intended documentation, including any files referenced by README.
  Any missing should be added to INSTALL_DOCS in the top-level Makefile.am

* Check out a second source directory for tools-only distribution
  bootstrap with: ./Bootstrap -o
  make a separate build directory, configure and gmake all distcheck
  to build the tools-only tarball

* Merge with Titanium and test SEGMENT_EVERYTHING functionality 

* Add new version number to Bugzilla

* Post to webpage, update HTML, email release notice with ChangeLog entry

* CVS tag the archive as GASNET_V_v (for version V.v) and docs/gasnet.texi as GASNETSPEC_V_v

* Increment overall public release version number in configure.in
   should be a odd minor and patch version number for development versions

